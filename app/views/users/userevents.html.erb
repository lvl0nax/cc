<div id='content'>
	<ul id="myitems" class="items">
		<h1><%= link_to "КАЛЕНДАРЬ", activities_user_path(@user.id) %> | <%= link_to "СОЗДАННЫЕ МЕРОПРИЯТИЯ", created_event_path %></h1>
	</ul>
	</br>
	<div id="celendar_content">
		<div class="monih12">
			<div class="month_info">
				<% @index = 1%>
				<% @action_events.each do |a_event|%>
					<%= render 'event_calendar', :event => a_event, :index => @index %>
					<% @index += 1%>			
				<%end%>
			</div>
			<div class="clr"></div>		
		</div>
		<div class="clr"></div>
	</div>
</div>
<script type="text/javascript" language="javascript">

	$(".monthcont").click(function () {
		
		var id_map = $(this).find('.mapwrap').attr('id');

		if($(this).find('.mapwrap').data('type') != 'Grant'){
			google_maps(id_map);
		}		

		$('.pk_popup').css({'display':'none'});
		$(this).children(".pk_popup").fadeIn(600);
		var w = ($(this).children(".pk_popup").width())/2;
		$(this).children(".pk_popup").css({'margin-top':-w});
	});		

	$(".close_popup").click(function () {
		$(this).parent(".pk_popup").fadeOut(600);
	});

	$(document).ready(function(){
	   $('.pk_popup, .monthcont').click(function(event){
		   event.stopPropagation();
	   });

	   $('.signature').on('click', function(){
      var id_event = $(this).attr('id');
      var str; 
      if ($(this).is(':checked')){
        str = 'add';
      }
      else{
        str = 'remove'
      } 
      $.ajax({ url: "/add_remove_event", type: "POST", data:{ id_event: id_event, str: str},  beforeSend:function(jqXHR, settings) {
                jqXHR.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'));
                }
      });     
    });

	}).click(function(){
		$('.pk_popup').fadeOut(200);
	});	

	function google_maps(id_map) {

	 var latlng = new google.maps.LatLng(49.83209,23.975322); // Координаты карты

		var settings = {

			zoom: 12, // Выставляем параметры зума для карты

			center: latlng,

			mapTypeControl: false,

			mapTypeControlOptions: {style: google.maps.MapTypeControlStyle.DROPDOWN_MENU},

			navigationControl: true,

			navigationControlOptions: {style: google.maps.NavigationControlStyle.SMALL},

			mapTypeId: google.maps.MapTypeId.ROADMAP

		};

		var map = new google.maps.Map(document.getElementById(""+id_map), settings); // Выбираем див куда ставить карту

		var myLatlng = new google.maps.LatLng(49.83209,23.975322);  // Координаты маркера

		var myOptions = {

			zoom: 12,  // Выставляем параметры зума для маркера

			center: myLatlng,

			mapTypeId: google.maps.MapTypeId.ROADMAP

		}  

		var map = new google.maps.Map(document.getElementById(""+id_map), myOptions);  // Выбираем див куда ставить маркер

		var marker = new google.maps.Marker({

		position: myLatlng,

		map: map,

		title: "A"

	  }); 

	}
</script>
